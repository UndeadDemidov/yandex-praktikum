# internal/app

##Инкремент 9

Добавьте в сервис функциональность аутентификации пользователя.

Сервис должен:
 - Выдавать пользователю симметрично подписанную куку, содержащую уникальный идентификатор пользователя, если такой куки не существует или она не проходит проверку подлинности.
 - Иметь хендлер `GET /api/user/urls`, который сможет вернуть пользователю все когда-либо сокращённые им URL в формате:

```json
[
  {
    "short_url": "https://...",
    "original_url": "https://..."
  }, "..."
]
```

 - При отсутствии сокращённых пользователем URL хендлер должен отдавать HTTP-статус `204 No Content`.

##Инкремент 10

 - Добавьте в сервис функциональность подключения к базе данных. В качестве СУБД используйте PostgreSQL не ниже 10 версии.
 - Добавьте в сервис хендлер `GET /ping`, который при запросе проверяет соединение с базой данных. При успешной проверке хендлер должен вернуть HTTP-статус `200 OK`, при неуспешной — `500 Internal Server Error`.
 - Строка с адресом подключения к БД должна получаться из переменной окружения `DATABASE_DSN` или флага командной строки `-d`.
   
##Инкремент 11

Перепишите сервис так, чтобы СУБД PostgreSQL стала хранилищем сокращённых URL вместо текущей реализации.

Сервису нужно самостоятельно создать все необходимые таблицы в базе данных. Схема и формат хранения остаются на ваше усмотрение.

При отсутствии переменной окружения `DATABASE_DSN` или флага командной строки `-d` или при их пустых значениях вернитесь последовательно к:
 - хранению сокращённых URL в файле при наличии соответствующей переменной окружения или флага командной строки;
 - хранению сокращённых URL в памяти.

##Инкремент 12
Задание для трека «Сервис сокращения URL»

Добавьте новый хендлер `POST /api/shorten/batch`, принимающий в теле запроса множество URL для сокращения в формате:
```json
[
  {
    "correlation_id": "<строковый идентификатор>",
    "original_url": "<URL для сокращения>"
  },
"..."
]
```
В качестве ответа хендлер должен возвращать данные в формате:
```json
[
  {
    "correlation_id": "<строковый идентификатор из объекта запроса>",
    "short_url": "<результирующий сокращённый URL>"
  },
"..."
]
``` 